{% extends "base.html" %}

{% load static %}

{% block extra_title %}- User Management{% endblock %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/user_admin.css' %}">
{% endblock %}

{% block content %}

<section class="user-admin-section section">
    <div class="section-container container-col box-shadow">
        <div class="search-container container-row">
            <div class="search-input-container container-row">
                <input type="text" placeholder="Search for first name, last name, email, status, purchase or end date" class="search-input">
                <div class="icon-container btn-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                        <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14" />
                    </svg>
                    <span class="sr-only">Search Icon</span>
                </div>
            </div>
        </div>

        <div class="heading-container container-row justify-start">
            <p class="first-name-heading item-heading dark-text-2 small-text">First Name</p>
            <p class="last-name-heading item-heading dark-text-2 small-text">Last Name</p>
            <p class="email-heading item-heading dark-text-2 small-text">Email</p>
            <p class="purchase-date-heading item-heading dark-text-2 small-text">Purchased</p>
            <p class="end-date-heading item-heading dark-text-2 small-text">Ending</p>
            <p class="status-heading item-heading dark-text-2 small-text">Membership Status</p>
        </div>

        
        <div class="users-container container-col">
            {% for item in all_users_profiles_and_memberships %}
            <div class="user-wrapper container-row relative-pos">
                <div class="user-container container-row justify-start" data-username="{{ item.user.username }}" data-first-name="{{ item.profile.first_name }}" data-last-name="{{ item.profile.last_name }}" data-email="{{ item.user.email }}" data-status="{{ item.membership.status.friendly_name }}" data-end-date="{{ item.membership.end_date|date:'m/d/Y' }}" data-purchase-date="{{ item.membership.purchase_date|date:'m/d/Y' }}" data-color="{{ item.membership.status.color }}">
                    <div class="img-container">
                        {% if item.profile.image %}
                        <img src="{{ item.profile.image.url }}" alt="{{ item.profile.first_name }}'s Profile Picture" class="img-100a">
                        {% else %}
                        <img src="{{ MEDIA_URL }}default-profile-picture.png" alt="Default Profile Picture" class="img-100a">
                        {% endif %}
                    </div>
                    <p class="first-name-text dark-text small-text">{{ item.profile.first_name }}</p>
                    
                    <p class="last-name-text dark-text small-text">{{ item.profile.last_name }}</p>
                    
                    <p class="email-text dark-text small-text">{{ item.user.email }}</p>
    
                    {% if item.membership.purchase_date %}
                    <p class="purchase-date-text dark-text small-text">{{ item.membership.purchase_date|date:"m/d/Y" }}</p>
                    {% else %}
                    <p class="purchase-date-text dark-text small-text">00/00/0000</p>
                    {% endif %}
                    
                    {% if item.membership.end_date %}
                    <p class="end-date-text dark-text small-text">{{ item.membership.end_date|date:"m/d/Y" }}</p>
                    {% else %}
                    <p class="end-date-text dark-text small-text">00/00/0000</p>
                    {% endif %}
    
                    <p class="status-text dark-text small-text color-{{ item.membership.status.color }}">
                        {{ item.membership.status.friendly_name }}
                    </p>
                </div>

                <div class="user-action-menu-btn action-menu-btn wrapper-menu absolute-pos hide">
                    <div class="btn-wrapper relative-pos">
                        <p class="icon-container dark-text gl-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                <path d="M7 12a2 2 0 1 1-4.001-.001A2 2 0 0 1 7 12m12-2a2 2 0 1 0 .001 4.001A2 2 0 0 0 19 10m-7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 12 10" />
                            </svg>
                            <span class="sr-only">Ellipisis Icon</span>
                        </p>
                        <div class="action-menu-container absolute-pos wrapper-menu">
                            <a href="{% url 'profile' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 16 16">
                                        <path d="M2.984 8.625v.003a.5.5 0 0 1-.612.355c-.431-.114-.355-.611-.355-.611l.018-.062s.026-.084.047-.145a6.7 6.7 0 0 1 1.117-1.982C4.096 5.089 5.605 4 8 4s3.904 1.089 4.802 2.183a6.7 6.7 0 0 1 1.117 1.982a4 4 0 0 1 .06.187l.003.013v.004l.001.002a.5.5 0 0 1-.966.258l-.001-.004l-.008-.025l-.035-.109a5.7 5.7 0 0 0-.945-1.674C11.286 5.912 10.045 5 8 5s-3.285.912-4.028 1.817a5.7 5.7 0 0 0-.945 1.674l-.035.109zM8 7a2.5 2.5 0 1 0 0 5a2.5 2.5 0 0 0 0-5M6.5 9.5a1.5 1.5 0 1 1 3 0a1.5 1.5 0 0 1-3 0" />
                                    </svg>
                                    <span class="sr-only">View Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">View Profile</span>
                            </a>
                            <a href="{% url 'edit_profile' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 20 20">
                                        <path d="M17.181 2.927a2.975 2.975 0 0 0-4.259-.054l-9.375 9.375a2.44 2.44 0 0 0-.656 1.194l-.877 3.95a.5.5 0 0 0 .596.597l3.927-.873a2.5 2.5 0 0 0 1.234-.678l9.358-9.358a2.975 2.975 0 0 0 .052-4.153m-3.552.653a1.975 1.975 0 1 1 2.793 2.793l-.671.671l-2.793-2.792zm-1.378 1.38l2.793 2.792l-7.98 7.98a1.5 1.5 0 0 1-.744.409l-3.16.702l.708-3.183c.059-.267.193-.511.386-.704z" />
                                    </svg>
                                    <span class="sr-only">Edit Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Profile</span>
                            </a>
                            <a href="{% url 'edit_profile_picture' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 256 256">
                                        <path d="M230.92 212c-15.23-26.33-38.7-45.21-66.09-54.16a72 72 0 1 0-73.66 0c-27.39 8.94-50.86 27.82-66.09 54.16a8 8 0 1 0 13.85 8c18.84-32.56 52.14-52 89.07-52s70.23 19.44 89.07 52a8 8 0 1 0 13.85-8M72 96a56 56 0 1 1 56 56a56.06 56.06 0 0 1-56-56" />
                                    </svg>
                                    <span class="sr-only">User Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Profile Picture</span>
                            </a>
                            <a href="{% url 'edit_membership' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M10.193 9.556L12 6.665l1.807 2.891a.85.85 0 0 0 1.221.237l3.88-2.822l-1.49 7.826a.25.25 0 0 1-.245.203H6.828a.25.25 0 0 1-.246-.203L5.092 6.97l3.88 2.822a.85.85 0 0 0 1.22-.237m2.528-4.568a.85.85 0 0 0-1.442 0L9.29 8.17L4.646 4.792c-.623-.453-1.48.09-1.335.846l1.797 9.44a1.75 1.75 0 0 0 1.72 1.422h10.345a1.75 1.75 0 0 0 1.719-1.423l1.797-9.439c.145-.756-.711-1.3-1.334-.846L14.71 8.17zM6 18a.75.75 0 0 0 0 1.5h12a.75.75 0 1 0 0-1.5z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">Membership Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Membership</span>
                            </a>
                            {% if item.pending_action %}
                            <a href="{% url 'change_membership_status' item.user.username True %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M20.207 6.793a1 1 0 0 1 0 1.414l-9.5 9.5a1 1 0 0 1-1.414 0l-4.5-4.5a1 1 0 0 1 1.414-1.414L10 15.586l8.793-8.793a1 1 0 0 1 1.414 0" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">Check Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Approve Membership</span>
                            </a>
                            <a href="{% url 'change_membership_status' item.user.username False %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M17.707 7.707a1 1 0 0 0-1.414-1.414L12 10.586L7.707 6.293a1 1 0 0 0-1.414 1.414L10.586 12l-4.293 4.293a1 1 0 1 0 1.414 1.414L12 13.414l4.293 4.293a1 1 0 1 0 1.414-1.414L13.414 12z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">X Mark Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Deny Membership</span>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

{% endblock %}

{% block postloadjs %}
{{ block.super }}

<script src="{% static 'js/user_admin.js' %}"></script>

{% endblock %}