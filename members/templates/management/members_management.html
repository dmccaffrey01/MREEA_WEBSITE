{% extends "base.html" %}

{% load static %}

{% block extra_title %}- Members Management{% endblock %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/user_admin.css' %}">
{% endblock %}

{% block content %}

<section class="user-admin-section section">
    <div class="section-container container-col box-shadow">
        <div class="search-container container-row">
            <div class="search-input-container container-row">
                <input type="text" placeholder="Search for name or email" class="search-input">
                <div class="icon-container btn-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                        <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14" />
                    </svg>
                    <span class="sr-only">Search Icon</span>
                </div>
            </div>
        </div>

        <div class="heading-container container-row justify-start">
            <p class="first-name-heading item-heading dark-text-2 small-text">First Name</p>
            <p class="last-name-heading item-heading dark-text-2 small-text">Last Name</p>
            <p class="email-heading item-heading dark-text-2 small-text">Email</p>
            <p class="purchase-date-heading item-heading dark-text-2 small-text">Purchased</p>
            <p class="end-date-heading item-heading dark-text-2 small-text">Ending</p>
            <p class="status-heading item-heading dark-text-2 small-text">Membership Status</p>
        </div>

        
        <div class="users-container container-col">
            {% for item in all_users_profiles_and_memberships %}
            <div class="user-wrapper container-row relative-pos">
                <div class="user-container container-row justify-start" data-username="{{ item.user.username }}" data-first-name="{{ item.profile.first_name }}" data-last-name="{{ item.profile.last_name }}" data-email="{{ item.user.email }}" data-status="{{ item.membership.status.friendly_name }}" data-end-date="{{ item.membership.end_date|date:'m/d/Y' }}" data-purchase-date="{{ item.membership.purchase_date|date:'m/d/Y' }}" data-color="{{ item.membership.status.color }}">
                    <div class="img-wrapper">
                        <div class="img-container">
                            {% if item.profile.image %}
                            <img src="{{ item.profile.image.url }}" alt="{{ item.profile.first_name }}'s Profile Picture" class="img-100a">
                            {% else %}
                            <img src="{{ MEDIA_URL }}default-profile-picture.png" alt="Default Profile Picture" class="img-100a">
                            {% endif %}
                        </div>
                        {% if item.user.is_superuser %}
                        <div class="admin-icon icon-container">
                            <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 256 256">
                                <path d="M128 80a48 48 0 1 0 48 48a48.05 48.05 0 0 0-48-48m0 80a32 32 0 1 1 32-32a32 32 0 0 1-32 32m88-29.84q.06-2.16 0-4.32l14.92-18.64a8 8 0 0 0 1.48-7.06a107.2 107.2 0 0 0-10.88-26.25a8 8 0 0 0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186 40.54a8 8 0 0 0-3.94-6a107.7 107.7 0 0 0-26.25-10.87a8 8 0 0 0-7.06 1.49L130.16 40h-4.32L107.2 25.11a8 8 0 0 0-7.06-1.48a107.6 107.6 0 0 0-26.25 10.88a8 8 0 0 0-3.93 6l-2.64 23.76q-1.56 1.49-3 3L40.54 70a8 8 0 0 0-6 3.94a107.7 107.7 0 0 0-10.87 26.25a8 8 0 0 0 1.49 7.06L40 125.84v4.32L25.11 148.8a8 8 0 0 0-1.48 7.06a107.2 107.2 0 0 0 10.88 26.25a8 8 0 0 0 6 3.93l23.72 2.64q1.49 1.56 3 3L70 215.46a8 8 0 0 0 3.94 6a107.7 107.7 0 0 0 26.25 10.87a8 8 0 0 0 7.06-1.49L125.84 216q2.16.06 4.32 0l18.64 14.92a8 8 0 0 0 7.06 1.48a107.2 107.2 0 0 0 26.25-10.88a8 8 0 0 0 3.93-6l2.64-23.72q1.56-1.48 3-3l23.78-2.8a8 8 0 0 0 6-3.94a107.7 107.7 0 0 0 10.87-26.25a8 8 0 0 0-1.49-7.06Zm-16.1-6.5a74 74 0 0 1 0 8.68a8 8 0 0 0 1.74 5.48l14.19 17.73a91.6 91.6 0 0 1-6.23 15l-22.6 2.56a8 8 0 0 0-5.1 2.64a74 74 0 0 1-6.14 6.14a8 8 0 0 0-2.64 5.1l-2.51 22.58a91.3 91.3 0 0 1-15 6.23l-17.74-14.19a8 8 0 0 0-5-1.75h-.48a74 74 0 0 1-8.68 0a8 8 0 0 0-5.48 1.74l-17.78 14.2a91.6 91.6 0 0 1-15-6.23L82.89 187a8 8 0 0 0-2.64-5.1a74 74 0 0 1-6.14-6.14a8 8 0 0 0-5.1-2.64l-22.58-2.52a91.3 91.3 0 0 1-6.23-15l14.19-17.74a8 8 0 0 0 1.74-5.48a74 74 0 0 1 0-8.68a8 8 0 0 0-1.74-5.48L40.2 100.45a91.6 91.6 0 0 1 6.23-15L69 82.89a8 8 0 0 0 5.1-2.64a74 74 0 0 1 6.14-6.14A8 8 0 0 0 82.89 69l2.51-22.57a91.3 91.3 0 0 1 15-6.23l17.74 14.19a8 8 0 0 0 5.48 1.74a74 74 0 0 1 8.68 0a8 8 0 0 0 5.48-1.74l17.77-14.19a91.6 91.6 0 0 1 15 6.23L173.11 69a8 8 0 0 0 2.64 5.1a74 74 0 0 1 6.14 6.14a8 8 0 0 0 5.1 2.64l22.58 2.51a91.3 91.3 0 0 1 6.23 15l-14.19 17.74a8 8 0 0 0-1.74 5.53Z" />
                            </svg>
                            <span class="sr-only">Admin Icon</span>
                        </div>
                        {% endif %}
                    </div>
                    <p class="first-name-text dark-text small-text">{{ item.profile.first_name }}</p>
                    
                    <p class="last-name-text dark-text small-text">{{ item.profile.last_name }}</p>
                    
                    <p class="email-text dark-text small-text">{{ item.user.email }}</p>
    
                    {% if item.membership.purchase_date %}
                    <p class="purchase-date-text dark-text small-text">{{ item.membership.purchase_date|date:"m/d/Y" }}</p>
                    {% else %}
                    <p class="purchase-date-text dark-text small-text">00/00/0000</p>
                    {% endif %}
                    
                    {% if item.membership.end_date %}
                    <p class="end-date-text dark-text small-text">{{ item.membership.end_date|date:"m/d/Y" }}</p>
                    {% else %}
                    <p class="end-date-text dark-text small-text">00/00/0000</p>
                    {% endif %}
    
                    <p class="status-text dark-text small-text color-{{ item.membership.status.color }}">
                        {{ item.membership.status.friendly_name }}
                    </p>
                </div>

                <div class="user-action-menu-btn action-menu-btn wrapper-menu absolute-pos hide">
                    <div class="btn-wrapper relative-pos">
                        <p class="icon-container dark-text gl-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                <path d="M7 12a2 2 0 1 1-4.001-.001A2 2 0 0 1 7 12m12-2a2 2 0 1 0 .001 4.001A2 2 0 0 0 19 10m-7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 12 10" />
                            </svg>
                            <span class="sr-only">Ellipisis Icon</span>
                        </p>
                        <div class="action-menu-container absolute-pos wrapper-menu">
                            <a href="{% url 'profile' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 16 16">
                                        <path d="M2.984 8.625v.003a.5.5 0 0 1-.612.355c-.431-.114-.355-.611-.355-.611l.018-.062s.026-.084.047-.145a6.7 6.7 0 0 1 1.117-1.982C4.096 5.089 5.605 4 8 4s3.904 1.089 4.802 2.183a6.7 6.7 0 0 1 1.117 1.982a4 4 0 0 1 .06.187l.003.013v.004l.001.002a.5.5 0 0 1-.966.258l-.001-.004l-.008-.025l-.035-.109a5.7 5.7 0 0 0-.945-1.674C11.286 5.912 10.045 5 8 5s-3.285.912-4.028 1.817a5.7 5.7 0 0 0-.945 1.674l-.035.109zM8 7a2.5 2.5 0 1 0 0 5a2.5 2.5 0 0 0 0-5M6.5 9.5a1.5 1.5 0 1 1 3 0a1.5 1.5 0 0 1-3 0" />
                                    </svg>
                                    <span class="sr-only">Eye Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">View Profile</span>
                            </a>
                            <a href="{% url 'edit_profile' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 256 256">
                                        <path d="M152 80a8 8 0 0 1 8-8h88a8 8 0 0 1 0 16h-88a8 8 0 0 1-8-8m96 40h-88a8 8 0 0 0 0 16h88a8 8 0 0 0 0-16m0 48h-64a8 8 0 0 0 0 16h64a8 8 0 0 0 0-16m-96.25 22a8 8 0 0 1-5.76 9.74a7.6 7.6 0 0 1-2 .26a8 8 0 0 1-7.75-6c-6.16-23.94-30.34-42-56.25-42s-50.09 18.05-56.25 42a8 8 0 0 1-15.5-4c5.59-21.71 21.84-39.29 42.46-48a48 48 0 1 1 58.58 0c20.63 8.71 36.88 26.29 42.47 48M80 136a32 32 0 1 0-32-32a32 32 0 0 0 32 32" />
                                    </svg>
                                    <span class="sr-only">Edit Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Profile</span>
                            </a>
                            <a href="{% url 'edit_profile_picture' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 256 256">
                                        <path d="M128 24a104 104 0 1 0 104 104A104.11 104.11 0 0 0 128 24M74.08 197.5a64 64 0 0 1 107.84 0a87.83 87.83 0 0 1-107.84 0M96 120a32 32 0 1 1 32 32a32 32 0 0 1-32-32m97.76 66.41a79.66 79.66 0 0 0-36.06-28.75a48 48 0 1 0-59.4 0a79.66 79.66 0 0 0-36.06 28.75a88 88 0 1 1 131.52 0" />
                                    </svg>
                                    <span class="sr-only">User Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Profile Picture</span>
                            </a>
                            <div class="action-item confirm-action-btn relative-pos">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 256 256">
                                        <path d="M144 157.68a68 68 0 1 0-71.9 0c-20.65 6.76-39.23 19.39-54.17 37.17a8 8 0 1 0 12.24 10.3C50.25 181.19 77.91 168 108 168s57.75 13.19 77.87 37.15a8 8 0 0 0 12.26-10.3c-14.95-17.78-33.53-30.41-54.13-37.17M56 100a52 52 0 1 1 52 52a52.06 52.06 0 0 1-52-52m196.25 43.07l-4.66-2.69a23.6 23.6 0 0 0 0-8.76l4.66-2.69a8 8 0 1 0-8-13.86l-4.67 2.7a23.9 23.9 0 0 0-7.58-4.39V108a8 8 0 0 0-16 0v5.38a23.9 23.9 0 0 0-7.58 4.39l-4.67-2.7a8 8 0 1 0-8 13.86l4.66 2.69a23.6 23.6 0 0 0 0 8.76l-4.66 2.69a8 8 0 0 0 8 13.86l4.67-2.7a23.9 23.9 0 0 0 7.58 4.39V164a8 8 0 0 0 16 0v-5.38a23.9 23.9 0 0 0 7.58-4.39l4.67 2.7a7.9 7.9 0 0 0 4 1.07a8 8 0 0 0 4-14.93M216 136a8 8 0 1 1 8 8a8 8 0 0 1-8-8" />
                                    </svg>
                                    <span class="sr-only">Make Admin Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">{% if item.user.is_superuser %}Remove{% else %}Add{% endif %} Admin Status</span>
                                <div class="confirm-action-container absolute-pos wrapper-menu">
                                    <p class="dark-text small-text">Confirm Action</p>
                                    <div class="confirm-options">
                                        <a href="{% url 'change_admin_status' item.user.username %}" class="icon-container dark-text gl-1 success">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                                <path fill-rule="evenodd" d="M20.207 6.793a1 1 0 0 1 0 1.414l-9.5 9.5a1 1 0 0 1-1.414 0l-4.5-4.5a1 1 0 0 1 1.414-1.414L10 15.586l8.793-8.793a1 1 0 0 1 1.414 0" clip-rule="evenodd" />
                                            </svg>
                                            <span class="sr-only">Check Icon</span>
                                        </a>
                                        <p class="deny-action-btn icon-container dark-text gl-1 error">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                                <path fill-rule="evenodd" d="M17.707 7.707a1 1 0 0 0-1.414-1.414L12 10.586L7.707 6.293a1 1 0 0 0-1.414 1.414L10.586 12l-4.293 4.293a1 1 0 1 0 1.414 1.414L12 13.414l4.293 4.293a1 1 0 1 0 1.414-1.414L13.414 12z" clip-rule="evenodd" />
                                            </svg>
                                            <span class="sr-only">Xmark Icon</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            {% if item.pending_action %}
                            <a href="{% url 'change_membership_status' item.user.username True %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M20.207 6.793a1 1 0 0 1 0 1.414l-9.5 9.5a1 1 0 0 1-1.414 0l-4.5-4.5a1 1 0 0 1 1.414-1.414L10 15.586l8.793-8.793a1 1 0 0 1 1.414 0" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">Check Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Approve Membership</span>
                            </a>
                            <a href="{% url 'change_membership_status' item.user.username False %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M17.707 7.707a1 1 0 0 0-1.414-1.414L12 10.586L7.707 6.293a1 1 0 0 0-1.414 1.414L10.586 12l-4.293 4.293a1 1 0 1 0 1.414 1.414L12 13.414l4.293 4.293a1 1 0 1 0 1.414-1.414L13.414 12z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">X Mark Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Deny Membership</span>
                            </a>
                            {% endif %}
                            <a href="{% url 'membership_management' item.user.username %}" class="action-item">
                                <span class="icon-container dark-text">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="dark-text" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M10.193 9.556L12 6.665l1.807 2.891a.85.85 0 0 0 1.221.237l3.88-2.822l-1.49 7.826a.25.25 0 0 1-.245.203H6.828a.25.25 0 0 1-.246-.203L5.092 6.97l3.88 2.822a.85.85 0 0 0 1.22-.237m2.528-4.568a.85.85 0 0 0-1.442 0L9.29 8.17L4.646 4.792c-.623-.453-1.48.09-1.335.846l1.797 9.44a1.75 1.75 0 0 0 1.72 1.422h10.345a1.75 1.75 0 0 0 1.719-1.423l1.797-9.439c.145-.756-.711-1.3-1.334-.846L14.71 8.17zM6 18a.75.75 0 0 0 0 1.5h12a.75.75 0 1 0 0-1.5z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="sr-only">Memberhsip Icon</span>
                                </span>
                                <span class="item-text dark-text small-text">Edit Membership</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

{% endblock %}

{% block postloadjs %}
{{ block.super }}

<script src="{% static 'js/user_admin.js' %}"></script>

{% endblock %}